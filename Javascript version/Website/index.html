<!DOCTYPE html>
<html>

<head>
  <title>TDR IN MAPS</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
      height: 100%;
    }

    /* Optional: Makes the sample page fill the window. */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    table, th, tr,caption {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 20px;
      text-align: left;
    }
  </style>
  <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
  
</head>

<body>
    
  <section class="container">
    <div id="map" style="float:left; width:90%;height:100vh;"></div>
    <div id="locationField">
      <input id="autocomplete" placeholder="Enter your origin" onFocus="geolocate()" type="text" />
    </div>
    <div id="locationField">
      <input id="originInput" placeholder="Enter your addresses" onFocus="geolocate()" type="text" />
    </div>


    <table id="listOfThings"style="border:1px solid black">
      <th>Addresses</th>
    </table>
  </section>
  
  

  <!-- Note: The address components in this sample are typical. You might need to adjust them for
               the locations relevant to your app. For more information, see
         https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete-addressform
    -->

  

  <script>



    var map;
    var marker;
    var addresses = new Array();
    var counter = 0;
    var service;

    var placeSearch, autocomplete, originInput;

    var componentForm = {
      street_number: 'short_name',
      route: 'long_name',
      locality: 'long_name',
      administrative_area_level_1: 'short_name',
      country: 'long_name',
      postal_code: 'short_name'
    };
    

    function initAutocomplete() {
      // Create the autocomplete object, restricting the search predictions to
      // geographical location types.
     
      var mapOptions = {
        center: new google.maps.LatLng(55.7635, 12.4949),
        zoom: 10,
      };

      map = new google.maps.Map(document.getElementById("map"), mapOptions);

      autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'), { types: ['geocode'] });
      originInput = new google.maps.places.Autocomplete(document.getElementById('originInput'), { types: ['geocode'] });
      var list = document.getElementById("listOfThings");
      for (var i = 0; i < 10; i++){
        var item = document.createElement('tr');
        item.appendChild(document.createTextNode("jeg er en kat"));
        list.appendChild(item);
      }
      



      // When the user selects an address from the drop-down, populate the
      // address fields in the form.
       
     
      // To add the marker to the map, call setMap();
 
      autocomplete.addListener('place_changed',addToList);

    }

    function addToList(){
      var place = autocomplete.getPlace();
      marker = new google.maps.Marker({
        position: place.geometry.location,
        title: place.name,
      });
      addresses.push(new google.maps.LatLng(place.geometry.location.lat(), place.geometry.location.lng()));
      marker.setMap(map);

      console.log(addresses);
      counter ++;
      if (counter == 2){
        service = new google.maps.DistanceMatrixService();
        service.getDistanceMatrix({
          origins: [addresses[0]],
          destinations: [addresses[1]],
          travelMode: 'TRANSIT',
          unitSystem: google.maps.UnitSystem.METRIC,
          avoidHighways: false,
          avoidTolls: false
        },callback)
        
      }

    }

  function callback(response, status) {
    if (status == 'OK') {
      var origins = response.originAddresses;
      var destinations = response.destinationAddresses;
      console.log(response.rows)
      
    } 
  }



    // Bias the autocomplete object to the user's geographical location,
    // as supplied by the browser's 'navigator.geolocation' object.
    function geolocate() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
          var geolocation = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          var circle = new google.maps.Circle(
            { center: geolocation, radius: position.coords.accuracy });
          autocomplete.setBounds(circle.getBounds());
          originInput.setBounds(circle.getBounds());
        });
      }
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCsVMd2HHo2ITwGggTsc7D05HinN_wogCY&libraries=places&callback=initAutocomplete"
    async defer></script>
</body>

</html>